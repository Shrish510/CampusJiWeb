<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Grievance Redressal - CampusJi</title>
    <meta name="description" content="Submit and track campus-related grievances through the CampusJi student portal at IPM IIM Rohtak. A secure and efficient platform for grievance redressal.">
    <meta name="keywords" content="CampusJi, IPM, grievance redressal, student portal, IIM Rohtak, student support, complaints">

    <!-- Open Graph Tags -->
    <meta property="og:title" content="Grievance Redressal - CampusJi Student Portal">
    <meta property="og:description" content="The CampusJi portal provides a confidential and streamlined process for submitting and tracking grievances at IPM IIM Rohtak.">
    <meta property="og:image" content="https://www.campusji.me/images/Campusjilogo.webp">
    <meta property="og:url" content="https://www.campusji.me/grievance">
    <meta property="og:type" content="website">

    <link rel="stylesheet" href="/css/main.css" />
    <link rel="stylesheet" href="/css/grievance.css" />
    <link
      rel="icon"
      href="images/Campusjilogo.webp"
      type="image/x-icon"
      style="border-radius: 50%"
    />

    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Lora:wght@400;500;600;700&display=swap"
      rel="stylesheet"
    />

    <style>
      /* --- Existing styles from your file --- */
      body {
        /* FONT AND BACKGROUND COLOR CHANGED HERE */
        font-family: "Lora", serif;
        background-color: #f5f1eb;
        color: #333;
      }
      .main-content {
        max-width: 900px;
        margin: 2rem auto;
        padding: 1rem;
      }
      .page-title {
        text-align: center;
        color: #2c3e50;
        margin-bottom: 2rem;
        font-size: 2.8rem; /* Larger title to suit the font */
      }
      .grievance-form-container,
      .grievance-table-container,
      .polling-section {
        background-color: #fff;
        padding: 2rem;
        border-radius: 12px;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
        margin-bottom: 2rem;
      }
      h2 {
        color: #2c3e50;
        margin-top: 0;
        border-bottom: 1px solid #eee;
        padding-bottom: 0.5rem;
        margin-bottom: 1.5rem;
      }
      .input-group {
        margin-bottom: 1.5rem;
      }
      .input-group label {
        display: block;
        margin-bottom: 0.5rem;
        font-weight: 500;
      }
      .input-group input,
      .input-group textarea {
        width: 100%;
        padding: 10px;
        border: 1px solid #ccc;
        border-radius: 8px;
        box-sizing: border-box;
        font-family: "Lora", serif; /* Ensure form fields also use the font */
      }
      .submit-button {
        display: block;
        width: 100%;
        padding: 12px;
        background-color: #2c3e50; /* Changed to match title color */
        color: white;
        border: none;
        border-radius: 8px;
        cursor: pointer;
        font-size: 1rem;
        font-weight: 600;
        font-family: "Lora", serif;
      }
      .grievance-table {
        width: 100%;
        border-collapse: collapse;
      }
      .grievance-table th,
      .grievance-table td {
        padding: 12px;
        text-align: left;
        border-bottom: 1px solid #eee;
      }
      .grievance-table th {
        background-color: #f8f9fa;
      }
      .status-pending {
        color: #d9a007;
        font-weight: bold;
      } /* Adjusted color for better readability */
      .status-resolved {
        color: #28a745;
        font-weight: bold;
      }

      /* --- Polling Section Styles --- */
      .polling-section p {
        color: #6c757d;
        text-align: center;
        margin-top: -1rem;
        margin-bottom: 2rem;
      }
      .poll-list {
        list-style: none;
        padding: 0;
        margin: 0;
      }
      .poll-list li {
        display: grid;
        grid-template-columns: 1fr auto;
        grid-template-areas: "issue button" "bar bar";
        align-items: center;
        gap: 1rem 1.5rem;
        padding: 1.25rem 0;
      }
      .poll-list li:not(:last-child) {
        border-bottom: 1px solid #f0f0f0;
      }
      .poll-issue {
        grid-area: issue;
        font-weight: 500;
      }
      .poll-bar-container {
        grid-area: bar;
        display: flex;
        align-items: center;
        gap: 1rem;
      }
      .poll-bar {
        flex-grow: 1;
        height: 10px;
        background-color: #e9ecef;
        border-radius: 5px;
        overflow: hidden;
      }
      .poll-bar-fill {
        height: 100%;
        background-color: #2c3e50; /* Changed to match title color */
        border-radius: 5px;
        transition: width 0.5s ease-in-out;
      }
      .poll-votes {
        font-size: 0.9rem;
        color: #6c757d;
        min-width: 60px;
        text-align: right;
      }
      .vote-btn {
        grid-area: button;
        padding: 8px 16px;
        border: 1px solid #2c3e50;
        color: #2c3e50;
        background-color: transparent;
        border-radius: 20px;
        cursor: pointer;
        font-weight: bold;
        transition: background-color 0.2s, color 0.2s;
        font-family: "Lora", serif;
      }
      .vote-btn:hover {
        background-color: #2c3e50;
        color: white;
      }
      .vote-btn[disabled] {
        background-color: #28a745;
        color: white;
        border-color: #28a745;
        cursor: not-allowed;
      }
    </style>
  </head>
  <body>
    <!-- Google Tag Manager (noscript) -->
    <noscript
      ><iframe
        src="https://www.googletagmanager.com/ns.html?id=GTM-TRVKNL4W"
        height="0"
        width="0"
        style="display: none; visibility: hidden"
      ></iframe
    ></noscript>
    <!-- End Google Tag Manager (noscript) -->

    <div id="header-container"></div>

    <main class="main-content">
      <h1 class="page-title">Grievance Redressal</h1>

      <!-- Admin Controls -->
      <div id="adminControls" style="display: none">
        <div class="admin-header">
          <h2>Admin Panel</h2>
          <button id="toggleViewBtn" class="toggle-btn">
            Switch to User View
          </button>
        </div>
      </div>

      <!-- User View -->
      <div id="userView">
        <div class="grievance-form-container">
          <h2>Submit a New Grievance</h2>
          <form id="grievanceForm">
            <div class="input-group">
              <label for="grievanceSubject">Subject</label>
              <input type="text" id="grievanceSubject" required />
            </div>
            <div class="input-group">
              <label for="grievanceDescription">Description</label>
              <textarea id="grievanceDescription" rows="5" required></textarea>
            </div>
            <button type="submit" class="submit-button">
              Submit Grievance
            </button>
          </form>
        </div>

        <div class="grievance-table-container">
          <h2>Your Grievances</h2>
          <table class="grievance-table">
            <thead>
              <tr>
                <th>User ID</th>
                <th>Subject</th>
                <th>Status</th>
                <th>Remarks</th>
              </tr>
            </thead>
            <tbody id="grievanceTableBody"></tbody>
          </table>
        </div>
      </div>

      <!-- Admin View -->
      <div id="adminView" style="display: none">
        <div class="admin-grievance-table-container">
          <h2>All Grievances (Admin View)</h2>
          <table class="grievance-table admin-table">
            <thead>
              <tr>
                <th>User ID</th>
                <th>Subject</th>
                <th>Description</th>
                <th>Status</th>
                <th>Remarks</th>
                <th>Actions</th>
              </tr>
            </thead>
            <tbody id="adminGrievanceTableBody">
              <!-- Admin table will be populated by JavaScript -->
            </tbody>
          </table>
        </div>
      </div>
    </main>

    <div id="footer-container"></div>

    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="/js/auth.js"></script>
    <script src="/js/common.js"></script>
    <script src="/js/grievance.js?v=4"></script>
  </body>
</html>
